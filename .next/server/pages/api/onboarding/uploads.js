"use strict";(()=>{var e={};e.id=119,e.ids=[119],e.modules={5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1428:e=>{e.exports=import("axios")},7313:e=>{e.exports=import("formidable")},3127:e=>{e.exports=import("react-phone-number-input")},1455:e=>{e.exports=require("node:fs/promises")},4691:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>u,default:()=>d,routeModule:()=>p});var i=a(9947),o=a(2706),l=a(6762),n=a(7944),s=e([n]);n=(s.then?(await s)():s)[0];let d=(0,l.M)(n,"default"),u=(0,l.M)(n,"config"),p=new i.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/onboarding/uploads",pathname:"/api/onboarding/uploads",bundlePath:"",filename:""},userland:n});r()}catch(e){r(e)}})},7944:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>u,default:()=>d});var i=a(214),o=a(7313),l=a(1455),n=a.n(l),s=e([i,o]);[i,o]=s.then?(await s)():s;let u={api:{bodyParser:!1}};async function d(e,t){if("POST"!==e.method){t.status(400);return}let a=(0,o.default)(),r=(await a.parse(e)).at(1);if(!r||!r.file){t.status(400).send({url:""});return}let l=r.file[0],s=await n().readFile(l.filepath),d=new File([s],l.originalFilename,{type:l.mimetype});try{let e=await i.S.upload(d);if(!e)throw Error("failed to generate cloud url");let a=new URL(e);console.log(a);let r=a.pathname.split("/").pop();t.status(200).json({url:r})}catch(e){console.log(e),t.status(500).send({url:""})}}r()}catch(e){r(e)}})},214:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{S:()=>d});var i=a(4473),o=a(8438),l=a(1428),n=e([o,l]);[o,l]=n.then?(await n)():n;let s=i.C+"/upload";class d{static{this.modifyFileName=(e,t,a={id:0,fileType:"signature"})=>{let r=e.name.split(".").pop(),i="file"===a.fileType?a.fieldName:`signature${a.id}`,o=`${i}_${t}_${new Date().getTime()}.${r}`;return new File([e],o,{type:e.type})}}static{this.upload=async e=>{if(!File)return;let t=new FormData;t.append("file",e),t.append("fileName",e.name);try{let e=await (0,l.default)(s,{data:t,method:"POST",withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});if(200===e.status)return e.data.url;console.log(e);return}catch(e){console.log(e)}}}static{this.download=async e=>{if(!e)return;let t=await o.k.statelessRequest("/api/onboarding/download?file="+e,{responseType:"blob"}),a=new Blob([t]);return URL.createObjectURL(a)}}static{this.uploadFileAndDownload=async e=>{if(e)try{let t=await o.k.statelessRequest("/api/onboarding/uploads",{data:{file:e},method:"POST",headers:{"Content-Type":"multipart/form-data"}});if(!t)return;let a=await this.download(t.url);if(!a)return;return{cloudURL:t.url,previewURL:a}}catch(e){console.log(e)}}}static{this.fileToURL=e=>new Promise((t,a)=>{let r=new FileReader;r.onload=()=>t(r.result),r.onerror=()=>a(r.error),r.readAsDataURL(e)})}}r()}catch(e){r(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[480],()=>a(4691));module.exports=r})();